"use strict";
require.config(requireConfig),require(["jquery","tmpl","i18n","bootstrap","common"],function(e,r,a,t,s){function n(){s.dao.paymentinfo({type:1,orderId:y},function(e){e&&o(e)},null,function(){p(y)})}function o(r){console.log("initPaymentMethodLayout");var a=r.channels;w=r.mdis;for(var t=0;t<a.length;t++){var n=a[t];2==n.extP4?x=n.channelId:1==n.extP4&&(k=n.channelId,n.MDisEnable=w.enabled)}if(e("#payment_method_list").html(e("#payMethodItemTempl").tmpl(a)),x)e("#"+x).attr("checked",!0),e("#bank_list_wrap").removeClass("hide"),e("#payment_card_wrap").addClass("hide"),e("#billing_address_wrap").addClass("hide"),e("#debit_card_label").text(e.i18n.map.DebitCard);else{if(e("#"+k+"_M_card").attr("checked",!0),e("#master_card").text(e.i18n.map.MASTERCARD),e("#visa_card").text(e.i18n.map.VISACARD),e("#m_card_dis_hint").text(w.mTitle),e("#error_card_number").text(e.i18n.map.CardNumErrorMsgM),e("#card_image").addClass("hide"),e("#card_no_input").css("background","url(../resources/img/m2.jpg) right center no-repeat"),s.util.isMobile()?e("#card_no_input").css("background-position-x","400px"):e("#card_no_input").css("background-position-x","260px"),e("#m_card_dis_info").removeClass("hide"),e("#grand_total").text(w.totalAfterMDis),e("#payment_btn span").html(e.i18n.map.PayNow+" ("+w.totalAfterMDis+")"),e("#mobile_payment_btn span").html(e.i18n.map.PayNow+" ("+w.totalAfterMDis+")"),b){var o=s.util.getCurrencySymbol(b.correncyCode);o||(o=s.util.getCurrencySymbol(s.util.getLocalCurrency())),e("#sub_total").text(s.util.formatProductPrice(b.realCost,o))}e("#bank_list_wrap").addClass("hide"),e("#payment_card_wrap").removeClass("hide"),e("#billing_address_wrap").removeClass("hide"),w.enabled&&1==w.enabled?(e("#sub_total_wrap").removeClass("hide"),e("#card_dis_title").text(w.mDisLable),e("#card_dis_total").text(w.mDisVal)):e("#sub_total_wrap").addClass("hide"),e("input[type=radio][name=payment_channel]").change(function(){if(this.value==k+"_1"){e("#bank_list_wrap").addClass("hide"),e("#payment_card_wrap").removeClass("hide"),e("#billing_address_wrap").removeClass("hide"),e("#payment_card_wrap").removeClass("hide"),e("#iframe_wrap").addClass("hide");var r=null;if(b){var r=s.util.getCurrencySymbol(b.correncyCode);r||(r=s.util.getCurrencySymbol(s.util.getLocalCurrency())),e("#sub_total").text(s.util.formatProductPrice(b.realCost,r))}e("#m_card_dis_info").removeClass("hide"),e("#card_no_input").css("background","url(../resources/img/m2.jpg) right center no-repeat"),s.util.isMobile()?e("#card_no_input").css("background-position-x","400px"):e("#card_no_input").css("background-position-x","260px"),l(),w.enabled&&1==w.enabled?(e("#card_dis_total").text(w.mDisVal),e("#grand_total").text(w.totalAfterMDis),e("#payment_btn span").html(e.i18n.map.PayNow+" ("+w.totalAfterMDis+")"),e("#mobile_payment_btn span").html(e.i18n.map.PayNow+" ("+w.totalAfterMDis+")"),e("#sub_total_wrap").removeClass("hide")):(e("#grand_total").text(s.util.formatProductPrice(b.realCost,r)),e("#payment_btn span").html(e.i18n.map.PayNow+" ("+s.util.formatProductPrice(b.realCost,r)+")"),e("#mobile_payment_btn span").html(e.i18n.map.PayNow+" ("+s.util.formatProductPrice(b.realCost,r)+")"),e("#sub_total_wrap").addClass("hide"))}else if(this.value==k+"_2"){e("#bank_list_wrap").addClass("hide"),e("#payment_card_wrap").removeClass("hide"),e("#billing_address_wrap").removeClass("hide");var r=null;b&&(r=s.util.getCurrencySymbol(b.correncyCode),r||(r=s.util.getCurrencySymbol(s.util.getLocalCurrency())),e("#sub_total").text(s.util.formatProductPrice(b.realCost,r)),e("#grand_total").text(s.util.formatProductPrice(b.realCost,r)),e("#payment_btn span").html(e.i18n.map.PayNow+" ("+s.util.formatProductPrice(b.realCost,r)+")"),e("#mobile_payment_btn span").html(e.i18n.map.PayNow+" ("+s.util.formatProductPrice(b.realCost,r)+")"),e("#sub_total_wrap").removeClass("hide")),e("#m_card_dis_info").removeClass("hide"),w.enabled&&1==w.enabled?e("#card_dis_total").text("-"+s.util.formatProductPrice(0,r)):e("#sub_total_wrap").addClass("hide"),B?(e("#payment_card_wrap").removeClass("hide"),e("#iframe_wrap").addClass("hide"),e("#card_no_input").css("background","url(../resources/img/v2.jpg) right center no-repeat"),s.util.isMobile()?e("#card_no_input").css("background-position-x","400px"):e("#card_no_input").css("background-position-x","260px"),l()):(e("#payment_card_wrap").addClass("hide"),e("#iframe_wrap").removeClass("hide"))}})}}function i(r){var a=I[r.currencyName];a&&a.length>0&&x?(e("#"+x).attr("disabled",!1),e("#debit_error_msg").addClass("hide"),e("#"+x).attr("checked",!0),e("#"+k).attr("checked",!1),e("#bank_list_wrap").removeClass("hide"),e("#bank_list_wrap").html(e("#bankItemTempl").tmpl(a)),e("#bank_list_wrap .bank-item-wrap").bind("click",function(){e("#error_message").hide(),e("#bank_list_wrap .bank-item-wrap img").removeClass("selected"),e(this).find("img").addClass("selected"),M=a[e(this).data().data]})):(e("#"+x).attr("disabled",!0),e("#debit_error_msg").removeClass("hide"),e("#bank_list_wrap").addClass("hide"),e("#"+x).attr("checked",!1),e("#"+k).attr("checked",!0),e("#payment_card_wrap").removeClass("hide"),e("#billing_address_wrap").removeClass("hide"))}function d(){var r=!0,a=e("input[name='payment_channel']:checked").val();if(a==k+"_1"||B){var t=m("#card_no_input","#error_card_number");r&&((r=t&&r)||(e("#card_no_input").focus(),setTimeout(function(){a==k?alert(e.i18n.map.CardNumErrorMsg):a==k+"_1"?alert(e.i18n.map.CardNumErrorMsgM):alert(e.i18n.map.CardNumErrorMsgV)},100))),e("#month_list").find("option:selected").text()==e.i18n.map.Month?(setTimeout(function(){alert(e.i18n.map.MonthYearErrorMsg)},100),r=!1,e("#month_list").focus(),e("#error_card_date").parent().addClass("show-error-text")):e("#error_card_date").parent().removeClass("show-error-text"),e("#year_list").find("option:selected").text()==e.i18n.map.Year?(r&&setTimeout(function(){alert(e.i18n.map.MonthYearErrorMsg)},100),r=!1,e("#year_list").focus(),e("#error_card_date").parent().addClass("show-error-text")):e("#error_card_date").parent().removeClass("show-error-text");var s=m("#cvv_input","#error_cvv");r&&((r=s&&r)||(e("#cvv_input").focus(),setTimeout(function(){alert(e.i18n.map.CvvErrorMsg)},100)))}else a==x&&(M||(r=!1,e("#error_message").html("Please select bank!"),e("#error_message").show(),setTimeout(function(){alert("Please select bank!")},1)));r&&h(!1)}function l(){var r=e("input[name='payment_channel']:checked").val();if(r==k+"_1"){e("#error_card_number").text(e.i18n.map.CardNumErrorMsgM);var a=e("#card_no_input").val(),t=new RegExp("^[5]");a&&t.test(a)?(e("#card_no_input").parent().addClass("has-success"),e("#card_no_input").parent().removeClass("has-error"),e("#error_card_number").parent().removeClass("show-error-text")):a&&(e("#card_no_input").parent().removeClass("has-success"),e("#card_no_input").parent().addClass("has-error"),e("#error_card_number").parent().addClass("show-error-text"),e("#error_card_number").text(e.i18n.map.CardNumErrorMsgM))}else if(r==k+"_2"){e("#error_card_number").text(e.i18n.map.CardNumErrorMsgV);var a=e("#card_no_input").val(),t=new RegExp("^[4]");a&&t.test(a)?(e("#card_no_input").parent().addClass("has-success"),e("#card_no_input").parent().removeClass("has-error"),e("#error_card_number").parent().removeClass("show-error-text")):a&&(e("#card_no_input").parent().removeClass("has-success"),e("#card_no_input").parent().addClass("has-error"),e("#error_card_number").parent().addClass("show-error-text"),e("#error_card_number").text(e.i18n.map.CardNumErrorMsgV))}}function c(){s.dao.getUserAddress({userId:s.util.getUserId(),addrType:2},function(r){var a=r;if(a&&a.length>0){for(var t=0;t<a.length;t++){var s=a[t];s.addrId==g&&e("#shipping_addr_dt").text(s.streetAddr+" "+s.extendAddr+" "+s.city+", "+s.province+", "+s.fullCountry+", "+s.postCode),s.isBillAddr&&(C=s,e("#billing_addr_dt").text(C.streetAddr+" "+C.extendAddr+" "+C.city+", "+C.province+", "+C.fullCountry+", "+C.postCode))}e("#first_name_input").val(C.recFirstname),e("#last_name_input").val(C.recLastname),e("#address_input").val(C.streetAddr),e("#address_2_input").val(C.extendAddr),e("#city_input").val(C.city),e("#postal_code_input").val(C.postCode),e("#email_input").val(C.email),e("#phone_input").val(C.telephone),e("#phone_2_input").val(C.telephone1)}_()})}function p(r){s.dao.getOrderDetail({orderId:r},function(r){if(r){b=r;var a=s.util.getCurrencySymbol(r.correncyCode);a||(a=s.util.getCurrencySymbol(s.util.getLocalCurrency()));for(var t=r.orderDisInfos,n=0;n<t.length;n++){var o=t[n];o.disCost<0?o.disCost="-"+s.util.formatProductPrice(-o.disCost,a):o.disCost="+"+s.util.formatProductPrice(o.disCost,a)}e("#dis_info_list").html(e("#disInfoTempl").tmpl(t)),e("#cart_total").html(s.util.formatProductPrice(r.totalCost,a)),w&&1==w.enabled?(e("#grand_total").text(w.totalAfterMDis),e("#sub_total").text(s.util.formatProductPrice(r.realCost,a)),e("#payment_btn span").html(e.i18n.map.PayNow+" ("+w.totalAfterMDis+")"),e("#mobile_payment_btn span").html(e.i18n.map.PayNow+" ("+w.totalAfterMDis+")")):(e("#grand_total").html(s.util.formatProductPrice(r.realCost,a)),e("#payment_btn span").html(e.i18n.map.PayNow+" ("+s.util.formatProductPrice(r.realCost,a)+")"),e("#mobile_payment_btn span").html(e.i18n.map.PayNow+" ("+s.util.formatProductPrice(r.realCost,a)+")"),e("#sub_total").text(s.util.formatProductPrice(r.realCost,a)));var d=r.shippingAddr;e("#shipping_addr_dt").text(d.streetAddr+" "+d.extendAddr+" "+d.city+", "+d.province+", "+d.fullCountry+", "+d.postCode),C=r.billAddr,e("#billing_addr_dt").text(C.streetAddr+" "+C.extendAddr+" "+C.city+", "+C.province+", "+C.fullCountry+", "+C.postCode),e("#first_name_input").val(C.recFirstname),e("#last_name_input").val(C.recLastname),e("#address_input").val(C.streetAddr),e("#address_2_input").val(C.extendAddr),e("#city_input").val(C.city),e("#postal_code_input").val(C.postCode),e("#email_input").val(C.email),e("#phone_input").val(C.telephone),e("#phone_2_input").val(C.telephone1),_(),C||(g=r.addrId,c()),i(a)}null==A&&h(!0)})}function _(){var r=document.getElementById("countryList");f=C?C.country:r.options[0].value,e("#countryList option[value='"+f+"']").prop("selected","selected"),e.getJSON("/resources/json/country.json",function(a){P=a;for(var t=r.value,s=0,n=0;n<a.length;n++){if(a[n].code===t){s=n;break}}if(a&&a[s]&&a[s].state&&a[s].state.length>0)u(a[s].state,!0),e("#provice_selected_wrap").show(),e("#provice_input_wrap").hide();else{document.getElementById("provinceList").length=0,e("#provice_selected_wrap").hide(),e("#provice_input_wrap").show()}e("#countryList").on("change",function(){var r=e(this).find("option:selected").val();f=r;for(var t=0,s=0;s<a.length;s++){if(a[s].code===f){t=s;break}}if(a&&a[t]&&a[t].state&&a[t].state.length>0)u(a[t].state),e("#provice_selected_wrap").show(),e("#provice_input_wrap").hide();else{document.getElementById("provinceList").length=0,e("#provice_selected_wrap").hide(),e("#provice_input_wrap").show()}})})}function u(r,a){if(r&&r.length>0){e("#provice_selected_wrap").show(),e("#provice_input_wrap").hide();var t=r;document.getElementById("provinceList").length=0;for(var s=0;s<t.length;s++){var n="<option value='"+t[s]+"'>"+t[s]+"</option>";a&&C&&C.province==t[s]&&(n="<option value='"+t[s]+"' selected>"+t[s]+"</option>"),e("#provinceList").append(n)}}else e("#provice_selected_wrap").hide(),e("#provice_input_wrap").show(),C&&e("#province_input").val(C.province)}function m(r,a){return!e(r).parent().hasClass("has-error")&&""!==e(r).val().trim()||(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e(a).parent().addClass("show-error-text"),!1)}function h(r){var a={},t={cardNo:e("#card_no_input").val(),expireY:e("#year_list").val(),expireM:e("#month_list").val(),secCode:e("#cvv_input").val()},n={os:s.util.getOS(),browerlang:s.util.getBrowserLang(),brower:s.util.getBrowser(),timezone:s.util.getTimezone(),screen:s.util.getResolution(),ismobile:s.util.isMobile()?"1":"0"},o="",i="",d=s.util.getAdvSource();d&&(o=d.t,i=d.u);var c=e("input[name='payment_channel']:checked").val();(c==k+"_2"||r)&&(t.cardNo="4444444444444444",t.expireY="4444",t.expireM="44",t.secCode="444"),c!=k+"_1"&&c!=k+"_2"||(c=k),a=o&&"null"!==o&&"undefined"!==o?{userId:s.util.getUserId(),currencyId:s.util.getLocalCurrency(),orderId:y,billAddrId:C?C.addrId:"",channelId:c,card:t,adsType:o,adsAccount:i,clientInfo:n,newUrl:"1"}:{userId:s.util.getUserId(),currencyId:s.util.getLocalCurrency(),orderId:y,billAddrId:C?C.addrId:"",channelId:c,card:t,adsAccount:i,clientInfo:n,newUrl:"1"},c==x?(a.billAddrId="",a.card={},a.banckCode=M.bankCode,a.banckPrdCode=M.code,e("#loading_hint").removeClass("hide")):e("#loading_hint").addClass("hide"),r||e(".loading-mask").removeClass("hide"),e("#error_message").hide(),e("#payment_btn").attr("disabled",!0),s.dao.payment({inputParams:JSON.stringify(a)},function(r){if(c==x){var a=r;e("body").append(a);document.getElementsByName("SendForm")[0].submit(),e(".loading-mask").addClass("hide"),e("#payment_btn").attr("disabled",!1)}else e(".loading-mask").addClass("hide"),e("#payment_btn").attr("disabled",!1),window.location.href="../../../payment_result.html?result=1&odi="+y},function(a){if(e(".loading-mask").addClass("hide"),e("#payment_btn").attr("disabled",!1),c==k)if("EC1004"==a.code||"EC1005"==a.code||"EC1006"==a.code)r?(B=!0,e("input[name='payment_channel']:checked").val()==k+"_2"&&(e("#payment_card_wrap").removeClass("hide"),e("#iframe_wrap").addClass("hide"),e("#card_no_input").css("background","url(../resources/img/v2.jpg) right center no-repeat"),s.util.isMobile()?e("#card_no_input").css("background-position-x","400px"):e("#card_no_input").css("background-position-x","260px"),l())):window.location.href="../../../payment_result.html?result=0&failCode="+a.code+"&failMsg="+encodeURI(a.msg);else if("EC1007"==a.code)if(r){A=a.data;var t=document.getElementById("v_card_wrap");t.setAttribute("src",A),e("#v_card_wrap").load(function(){e("#iframe_loading").addClass("hide")})}else window.location.href=a.data;else e("#error_message").html(a.msg),e("#error_message").show(),alert(a.msg);else window.location.href="../../../payment_result.html?result=0&failCode=EC1005"},function(){e("#card_no_input").val(""),e("#cvv_input").val("")})}function v(e){if(P)for(var r=0;r<P.length;r++){var a=P[r];if(a.code==e)return a.name}return e}console.log("checkout_payment2.js");var C,f,g,b,w,y=s.util.getQueryString("orderId"),x="",k="",P=null,I={MYR:[{name:"Maybank",bankCode:"FPXD_MB2U0227",code:"25",img:"maybank.png"},{name:"CIMB",bankCode:"FPXD_BCBB0235",code:"25",img:"CIMBBank.png"},{name:"Public Bank",bankCode:"FPXD_PBB0233",code:"25",img:"PublicBankBerhad.png"},{name:"RHB",bankCode:"FPXD_RHB0218",code:"25",img:"RHBBank.png"},{name:"Hong Leong Bank",bankCode:"FPXD_HLB0224",code:"25",img:"HongLeongBank.png"},{name:"Bank Islam",bankCode:"FPXD_BIMB0340",code:"25",img:"BankIslam.png"}],THB:[{name:"United oversea Bank",bankCode:"FPXD_UOB0226",code:"27",img:"UnitedOverseasBank.png"}]},M=null,A=null,B=!1;s.initLoginStatus(function(e){e?n():window.location.href="../../../login.html"}),e("#order_no_dt").text(y),e("#card_no_input").val(""),e("#cvv_input").val(""),function(){e("#payment_btn, #mobile_payment_btn").click(function(){d()}),e("#what_cvv_btn").click(function(){e("#cvv_desc_wrap").removeClass("hide")}),e("#close_btn").click(function(){e("#cvv_desc_wrap").addClass("hide")}),e("#edit_credit_address").click(function(){e("#edit_shipping_address_wrap").removeClass("hide"),e("#cancel_credit_address").removeClass("hide"),e("#edit_credit_address").addClass("hide")}),e("#cancel_credit_address").click(function(){e("#edit_credit_address").removeClass("hide"),e("#edit_shipping_address_wrap").addClass("hide"),e("#cancel_credit_address").addClass("hide")}),e("#save_credit_address").click(function(){var r=!0,a=m("#first_name_input","#error_first_name");r&&((r=a&&r)||e("#first_name_input").focus());var t=m("#last_name_input","#error_last_name");r&&((r=t&&r)||e("#last_name_input").focus());var n=!0,o=s.util.checkAddress(e("#address_input").val());0==o?(e("#address_input").parent().removeClass("has-success"),e("#address_input").parent().addClass("has-error"),e("#error_address").parent().addClass("show-error-text"),n=!1):-1==o?(e("#address_input").parent().removeClass("has-success"),e("#address_input").parent().addClass("has-error"),e("#error_address").parent().addClass("show-error-text"),n=!1):1==o&&(e("#address_input").parent().removeClass("has-error"),e("#address_input").parent().addClass("has-success"),e("#error_address").parent().removeClass("show-error-text")),r&&((r=n&&r)||e("#address_input").focus()),n=!0,o=s.util.checkAddress(e("#address_2_input").val()),-1==o?(e("#address_2_input").parent().removeClass("has-success"),e("#address_2_input").parent().addClass("has-error"),e("#error_address_2").parent().addClass("show-error-text"),n=!1):(e("#address_2_input").parent().removeClass("has-error"),e("#address_2_input").parent().addClass("has-success"),e("#error_address_2").parent().removeClass("show-error-text")),r&&((r=n&&r)||e("#address_2_input").focus());var i=m("#city_input","#error_city");r&&((r=i&&r)||e("#city_input").focus());var d=m("#postal_code_input","#error_postal_code");r&&((r=d&&r)||e("#postal_code_input").focus());var l=m("#email_input","#error_email");r&&((r=l&&r)||e("#email_input").focus());var p=m("#phone_input","#error_phone");if(r&&((r=p&&r)||e("#phone_input").focus()),e("#provice_input_wrap").is(":visible")){var _=m("#province_input","#error_province");r&&((r=_&&r)||e("#province_input").focus())}if(r){e(".loading-mask").removeClass("hide"),e("#save_credit_address").attr("disabled",!0);var u=e("#provinceList").val();e("#provice_input_wrap").is(":visible")&&(u=e("#province_input").val());var h={addrId:C.addrId,userId:s.util.getUserId(),country:f,fullCountry:v(f),province:u,city:e("#city_input").val(),streetAddr:e("#address_input").val(),extendAddr:e("#address_2_input").val(),email:e("#email_input").val().trim(),postCode:e("#postal_code_input").val(),telephone:e("#phone_input").val(),telephone1:e("#phone_2_input").val(),recFirstname:e("#first_name_input").val(),recLastname:e("#last_name_input").val(),isDefault:1,isBillAddr:1};s.dao.updateAddress({inputParams:JSON.stringify(h)},function(r){e("#edit_shipping_address_wrap").addClass("hide"),e("#edit_credit_address").removeClass("hide"),e("#cancel_credit_address").addClass("hide"),c()},null,function(r){e(".loading-mask").addClass("hide"),e("#save_credit_address").attr("disabled",!1)})}}),e("#cancel_btn").click(function(){e("#edit_credit_address").removeClass("hide"),e("#edit_shipping_address_wrap").addClass("hide"),e("#cancel_credit_address").addClass("hide")}),s.util.isMobile()&&e(window).scroll(function(){s.util.isElementInViewport(document.getElementById("payment_btn"))?e("#mobile_payment_btn").addClass("hide"):e("#mobile_payment_btn").removeClass("hide")}),window.addEventListener("message",function(r){"close"==r.data.closeLayer?window.confirm(e.i18n.map.CancelPaymentHint)&&(window.location.href="../../../my_account.html"):r.data.redirect_url&&(window.location.href=r.data.redirect_url)})}(),function(){var r=sessionStorage.userInfo;r&&(r=JSON.parse(r),e("#first_name_input").val(r.firstName),e("#last_name_input").val(r.lastName)),e("#first_name_input").blur(function(){var r=s.util.checkNull(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_first_name").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_first_name").parent().removeClass("show-error-text"))}),e("#last_name_input").blur(function(){var r=s.util.checkNull(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_last_name").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_last_name").parent().removeClass("show-error-text"))}),e("#address_input").blur(function(){var r=s.util.checkAddress(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_address").parent().addClass("show-error-text")):-1==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_address").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_address").parent().removeClass("show-error-text"))}),e("#address_2_input").blur(function(){-1==s.util.checkAddress(e(this).val())?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_address_2").parent().addClass("show-error-text")):(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_address_2").parent().removeClass("show-error-text"))}),e("#city_input").blur(function(){var r=s.util.checkNull(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_city").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_city").parent().removeClass("show-error-text"))}),e("#province_input").blur(function(){var r=s.util.checkNull(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_province").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_province").parent().removeClass("show-error-text"))}),e("#postal_code_input").blur(function(){var r=s.util.checkPhone(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_postal_code").parent().addClass("show-error-text")):-1==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_postal_code").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_postal_code").parent().removeClass("show-error-text"))}),e("#email_input").blur(function(){var r=s.util.checkEmail(e(this).val().trim());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_email").parent().addClass("show-error-text")):-1==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_email").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_email").parent().removeClass("show-error-text"))}),e("#phone_input").blur(function(){var r=s.util.checkPhone(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_phone").parent().addClass("show-error-text")):-1==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_phone").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_phone").parent().removeClass("show-error-text"))}),e("#card_no_input").blur(function(){var r=s.util.checkNull(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_card_number").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_card_number").parent().removeClass("show-error-text"),e("#error_card_number").text(e.i18n.map.CardNumErrorMsg)),l()}),document.getElementById("card_no_input").addEventListener("input",function(e){l()}),e("#cvv_input").blur(function(){var r=s.util.checkNull(e(this).val());0==r?(e(this).parent().removeClass("has-success"),e(this).parent().addClass("has-error"),e("#error_cvv").parent().addClass("show-error-text")):1==r&&(e(this).parent().removeClass("has-error"),e(this).parent().addClass("has-success"),e("#error_cvv").parent().removeClass("show-error-text"))})}(),function(){for(var r=[e.i18n.map.Month,"01","02","03","04","05","06","07","08","09","10","11","12"],a=document.getElementById("month_list"),t=0;t<r.length;t++)a.add(new Option(r[t],r[t]));e("#month_list").on("change",function(){e("#month_list").find("option:selected").text()!==e.i18n.map.Month&&e("#year_list").find("option:selected").text()!==e.i18n.map.Year&&e("#error_card_date").parent().removeClass("show-error-text")})}(),function(){for(var r=(new Date).getFullYear(),a=[e.i18n.map.Year],t=r;t<=r+10;t++)a.push(t);for(var s=document.getElementById("year_list"),t=0;t<a.length;t++)s.add(new Option(a[t],a[t])),e("#error_message").hide();e("#year_list").on("change",function(){e("#month_list").find("option:selected").text()!==e.i18n.map.Month&&e("#year_list").find("option:selected").text()!==e.i18n.map.Year&&e("#error_card_date").parent().removeClass("show-error-text")})}(),e("#currency_group").hide()});